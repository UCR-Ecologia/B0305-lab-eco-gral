---
subtitle: "B0305 -- Lab Eco Gral<br><a href='https://ucr-ecologia.github.io/B0305-lab-eco-gral/' target='_blank'>https://ucr-ecologia.github.io/B0305-lab-eco-gral/</a>"
title: "<font style='font-size:1em;'>An√°lisis de datos de conteo en ecolog√≠a</font>"
author: "Prof. Teo Nakov"
institute: 'Escuela de Biologia, Universidad de Costa Rica'
date: "04 September 2025"
date-meta: "04 September 2025"
date-format: "DD MMM YYYY"
toc: true
toc-depth: 1
toc-title: "Que vamos a ver:"
center-title-slide: false
from: markdown+emoji
format:
  revealjs: 
    fig-responsive: true
    theme: simple
    slide-number: true
    mouse-wheel: false
    preview-links: auto
    incremental: false
    logo: /figures/icons/course_favicon.png
    css: /css/styles_slides.css
    footer: 'B0305 -- Lab Eco Gral'
---

## ¬øQu√© son los Datos de Conteo? {.smaller}

- **Definici√≥n**: N√∫meros enteros no negativos que representan el n√∫mero de ocurrencias de un evento
- **Rango**: 0, 1, 2, 3, 4, ...
- **No pueden ser negativos ni fraccionarios**

. . .

**¬øPor qu√© tratamiento especial?**

- Discretos, no continuos
- Distribuciones a menudo sesgadas
- La varianza a menudo est√° relacionada con la media

---

## Datos de Conteo en Biolog√≠a y Ecolog√≠a {.smaller}

**Ejemplos comunes:**

- N√∫mero de especies en un cuadrante
- Semillas por fruto
- Par√°sitos por hospedero
- Descendencia por individuo
- Visitantes a flores por hora
- Cajas nido ocupadas por sitio

. . .

**¬øPor qu√© esto importa?**

¬°Las distribuciones normales y modelos lineales pueden no ser apropiados!

---

## La Distribuci√≥n de Poisson {.smaller}

**La distribuci√≥n "por defecto" para datos de conteo**

- Par√°metro: Œª (lambda) = media = varianza
- Supuesto: los eventos ocurren independientemente

. . .

**Propiedad clave**: La media es igual a la varianza

- Si media = 3, entonces varianza = 3
- Esto a menudo se **viola** en datos ecol√≥gicos

---

## Problemas con Datos de Conteo Ecol√≥gicos {.smaller}

**Dos problemas principales:**

1. **Sobredispersi√≥n** - varianza > media
2. **Inflaci√≥n de ceros** - m√°s ceros de los esperados

. . .

**¬øPor qu√© ocurren en ecolog√≠a?**

- **Sobredispersi√≥n**: Agregaci√≥n espacial, heterogeneidad ambiental, variables no medidas
- **Inflaci√≥n de ceros**: Ausencias verdaderas vs. fallas de detecci√≥n, idoneidad del h√°bitat

---

## Sobredispersi√≥n en Detalle {.smaller}

::: {.columns}
::: {.column}
**¬øQu√© es?**

- La varianza excede la media
- Indica variabilidad extra no capturada por Poisson

**Causas en ecolog√≠a:**

- Agregaci√≥n espacial (organismos se agrupan)
- Heterogeneidad ambiental
- Diferencias individuales en rasgos
- Covariables no medidas

:::
::: {.column}


**Consecuencias estad√≠sticas:**

- Errores est√°ndar subestimados
- Valores p artificialmente peque√±os
- **Incremento en tasas de error Tipo I** (encontrar diferencias que no existen)
- Conclusiones excesivamente confiadas

:::
:::


---

## Errores Tipo I y Tipo II {.smaller}

::: {.callout-important title="Recordatorio: Tipos de Error Estad√≠stico"}

| Realidad vs Decisi√≥n | No rechazar H‚ÇÄ | Rechazar H‚ÇÄ |
|:-------------------:|:--------------:|:-----------:|
| **H‚ÇÄ es verdadera** | ‚úì Correcto | ‚ùå **Error Tipo I** |
| **H‚ÇÄ es falsa** | ‚ùå **Error Tipo II** | ‚úì Correcto |

**Error Tipo I (Œ±)**: Rechazar H‚ÇÄ cuando es verdadera ("falso positivo")  
**Error Tipo II (Œ≤)**: No rechazar H‚ÇÄ cuando es falsa ("falso negativo")

**En contexto de sobredispersi√≥n**: Ignorar la sobredispersi√≥n **eleva** Error Tipo I
:::

---

## Inflaci√≥n de Ceros en Detalle {.smaller}

**¬øQu√© es?**

- M√°s ceros observados que los predichos por Poisson (o Binomial Negativa)

. . .

**Dos tipos de ceros:**

1. **Ceros estructurales**: Ausencias "verdaderas" (h√°bitat no adecuado)
2. **Ceros de muestreo**: Presente pero no detectado

. . .

**Ejemplos:**

- Conteos de peces en arroyos (algunos sitios no adecuados para peces)
- Cargas parasitarias (algunos hospederos resistentes)
- Conteos de plantas (algunas parcelas carecen de condiciones adecuadas)

---

## Evaluando la Sobredispersi√≥n {.smaller}

**Paso 1: Calcular par√°metro de dispersi√≥n**

- œÜ = Devianza residual / Grados de libertad residuales
- œÜ ‚âà 1: Poisson es adecuado
- œÜ > 1: Sobredispersi√≥n presente

. . .

**Paso 2: Pruebas formales**

- **LRT**: Comparar Poisson vs. Binomial Negativa
- **AIC/BIC**: Criterios de informaci√≥n para selecci√≥n de modelos

---

## Evaluando la Inflaci√≥n de Ceros {.smaller}

**Evaluaci√≥n visual:**

- Comparar conteos de ceros observados vs. esperados
- Histograma de la distribuci√≥n de datos

. . .

**Pruebas formales:**

- **LRT**: Modelos con inflaci√≥n de ceros vs. est√°ndar
- **AIC/BIC**: Comparaci√≥n de criterios de informaci√≥n

. . .

**Regla pr√°ctica:**

Si >60-70% son ceros, considerar modelos de inflaci√≥n de ceros

---

## Comparaci√≥n de Modelos {.smaller}

| Modelo | Cu√°ndo usar | Pregunta t√≠pica | Ventaja principal | Desventaja principal |
|--------|-------------|-----------------|-------------------|---------------------|
| **Poisson** | Media ‚âà varianza<br>Sin exceso de ceros | ¬øC√≥mo afecta X la abundancia? | Sencillo e interpretable | Asume equidispersi√≥n<br>(rara en ecolog√≠a) |
| **Binomial Negativa** | Sobredispersi√≥n<br>presente | ¬øQu√© factores afectan abundancia con variabilidad realista? | Maneja sobredispersi√≥n<br>Interpretaci√≥n similar a Poisson | No maneja inflaci√≥n<br>de ceros |
| **ZIP/ZINB** | Exceso de ceros<br>¬± sobredispersi√≥n | ¬øQu√© determina presencia vs. abundancia? | Modela dos procesos<br>biol√≥gicos distintos | M√°s complejo<br>Requiere justificaci√≥n<br>biol√≥gica |

---

<!-- ---

## Modelos para Datos de Conteo {.smaller}

**Jerarqu√≠a de complejidad:**

1. **GLM de Poisson**: Datos de conteo bien comportados
2. **Binomial Negativa**: Datos sobredispersos
3. **Modelos con inflaci√≥n de ceros**: Exceso de ceros + sobredispersi√≥n

--- -->

<!-- 
## GLM de Poisson {.smaller}

**Cu√°ndo usarlo:**

- Media ‚âà varianza
- Sin inflaci√≥n obvia de ceros
- Procesos de conteo simples

. . .

**Tipos de preguntas:**

- ¬øC√≥mo afecta el tratamiento la abundancia?
- ¬øQu√© factores ambientales predicen los conteos?
- ¬øHay diferencias entre grupos?

. . .

--- -->

<!-- ## GLM de Poisson: Advertencias {.smaller}

**Cuidado con:**

- **Sobredispersi√≥n**: Verificar devianza residual
- **Inflaci√≥n de ceros**: Observar patrones residuales
- **Valores at√≠picos**: Observaciones influyentes
- **Supuestos del modelo**: Independencia, funci√≥n de enlace correcta -->

<!-- . . .

**Diagn√≥sticos:**

- Gr√°ficos de residuos
- Gr√°ficos QQ de residuos
- An√°lisis de observaciones influyentes -->
<!-- 
---

## Modelos Binomial Negativa {.smaller}

**Cu√°ndo usarlos:**

- Sobredispersi√≥n presente (varianza > media)
- Modelo de Poisson inadecuado
- Variabilidad extra de fuentes no medidas

. . .

**Par√°metro adicional:**

- **Par√°metro de dispersi√≥n (Œ∏)**: Controla la cantidad de sobredispersi√≥n
- Cuando Œ∏ ‚Üí ‚àû, se aproxima a Poisson
- Œ∏ m√°s peque√±o = m√°s sobredispersi√≥n

. . .

**Interpretaci√≥n:** Similar a Poisson, pero con incertidumbre realista

---

## Binomial Negativa: Tipos de Preguntas {.smaller}

**Preguntas de investigaci√≥n:**

- Igual que Poisson, pero con estimaciones de incertidumbre apropiadas
- "¬øQu√© factores afectan la abundancia, considerando la variabilidad natural?"
- Comparaciones entre grupos con intervalos de confianza realistas

. . .

**Ventajas:**

- M√°s conservador (intervalos de confianza m√°s amplios)
- Mejor ajuste del modelo para datos sobredispersos
- Robusto a desviaciones moderadas de los supuestos

--- -->

<!-- ## Binomial Negativa: Advertencias {.smaller}

**A√∫n necesita verificar:**

- **Inflaci√≥n de ceros**: Puede estar presente a√∫n
- **Supuestos del modelo**: Funci√≥n de enlace, independencia
- **Convergencia**: La estimaci√≥n puede ser desafiante

. . .

**Cu√°ndo no es suficiente:**

- Ceros excesivos requieren modelos con inflaci√≥n de ceros
- Relaciones no lineales necesitan enfoques diferentes
- Correlaci√≥n espacial/temporal requiere modelos mixtos

--- -->
<!-- 
## Modelos con Inflaci√≥n de Ceros {.smaller}

**Dos componentes:**

1. **Proceso binario**: Probabilidad de cero "verdadero" vs. potencial no-cero
2. **Proceso de conteo**: Poisson o Binomial Negativa para la parte no-cero

. . .

**ZIP**: Poisson con Inflaci√≥n de Ceros  
**ZINB**: Binomial Negativa con Inflaci√≥n de Ceros

. . .

**Interpretaci√≥n:**

- Coeficientes para proceso de inflaci√≥n de ceros (log√≠stico)
- Coeficientes para proceso de conteo (log-lineal)

---

## Modelos con Inflaci√≥n de Ceros: Aplicaciones {.smaller}

**Preguntas de investigaci√≥n:**

- "¬øQu√© determina presencia vs. ausencia?"
- "Dada la presencia, ¬øqu√© afecta la abundancia?"
- Procesos ecol√≥gicos de dos etapas

. . .

**Ejemplos:**

- Producci√≥n de semillas: Plantas reproductivas vs. no reproductivas
- Conteos de enfermedades: Hospederos susceptibles vs. resistentes
- Ocurrencia de especies: H√°bitat adecuado vs. no adecuado -->

<!-- --- -->

<!-- ## Modelos con Inflaci√≥n de Ceros: Advertencias {.smaller}

**Complejidad:**

- M√°s par√°metros que estimar
- Selecci√≥n de modelos desafiante
- La interpretaci√≥n requiere cuidado

. . .

**Cu√°ndo evitarlos:**

- Tama√±os de muestra peque√±os
- Justificaci√≥n biol√≥gica poco clara para dos procesos
- Cuando modelos m√°s simples son adecuados

--- -->

## Selecci√≥n de Modelos {.smaller}

::: {.columns}
::: {.column}
**Criterios de informaci√≥n:**

- **AIC**: Criterio de Informaci√≥n de Akaike (m√°s tolerante a la complejidad del modelo)
- **BIC**: Criterio de Informaci√≥n Bayesiano (m√°s conservador, tiende a favorecer modelos simples)
- Valores menores indican mejor ajuste

:::
::: {.column}
**LRT:**

- **Solo para modelos anidados**
- **OK:** Poisson vs. Binomial Negativa ‚úì, ZIP vs. ZINB ‚úì
- **NOT OK:** Poisson vs. ZIP ‚úó, Poisson vs. ZINB ‚úó, Binomial Negativa vs. ZINB ‚úó (no anidados)

:::
::: 

<!-- ::: {.callout-important title = "Ojo"}
**Para modelos no anidados:** Usar solo AIC/BIC
::: -->

::: {.callout-tip title="Leer m√°s"}
$AIC = -2 √ó log-likelihood + 2 √ó k$  
$BIC = -2 √ó log-likelihood + ln(n) √ó k$

Donde: k = n√∫mero de par√°metros, n = tama√±o de muestra. Como ln(n) > 2 cuando n > 7, BIC penaliza par√°metros adicionales m√°s fuertemente que AIC.

Burnham, K.P. & Anderson, D.R. (2002). *Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach*
:::

---

## Interpretaci√≥n de Resultados {.smaller}

**Coeficientes Poisson/Binomial Negativa:**

- **Coeficiente crudo**: Cambio en log(media) por incremento unitario
- **Coeficiente exponenciado**: Cambio multiplicativo en la media
- exp(Œ≤) = 1.5 significa incremento del 50%

. . .

**Ejemplo:**

- Œ≤ = 0.405 ‚Üí exp(0.405) = 1.5
- "Un incremento unitario en X se asocia con incremento del 50% en el conteo esperado"

. . .

::: {.callout-important title = "Recordar"}
**Siempre reportar intervalos de confianza** - La incertidumbre es parte fundamental del resultado
:::

---

## Resumen {.smaller}

**Mensajes clave:**

1. Los datos de conteo requieren tratamiento estad√≠stico especial
2. Verificar sobredispersi√≥n e inflaci√≥n de ceros
3. Empezar simple, agregar complejidad seg√∫n sea necesario
4. La selecci√≥n de modelos es crucial
5. Interpretar resultados en contexto biol√≥gico

. . .

**Recordar:**

- Los modelos son herramientas, no verdades
- Los supuestos importan
- El entendimiento biol√≥gico gu√≠a las decisiones estad√≠sticas

---

## Pr√≥ximos pasos {.smaller}

- An√°lisis pr√°ctico con datos ecol√≥gicos reales
- Experiencia pr√°ctica con ajuste de modelos
- Gr√°ficos de diagn√≥stico y verificaci√≥n de modelos

---

## Bibliograf√≠a {.smaller}

- **Gotelli, N.J. & Ellison, A.M.** (2004). *A Primer of Ecological Statistics*. Sinauer Associates. [üìÑ PDF - Cap. 6](../../../refs/Gotelli-2004-cap-6.pdf)

**Recursos adicionales:**

- **Burnham, K.P. & Anderson, D.R.** (2002). *Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach*. 2nd ed. Springer-Verlag.

- **Zuur, A.F., Ieno, E.N., Walker, N.J., Saveliev, A.A. & Smith, G.M.** (2009). *Mixed Effects Models and Extensions in Ecology with R*. Springer.

- **Bolker, B.M.** (2008). *Ecological Models and Data in R*. Princeton University Press.
